id: extract-response-parameters

info:
  name: Extract All Parameters from HTTP Response
  author: Souf.Z
  severity: informational
  description: Extracts all parameters from HTTP responses, including query parameters, headers, and potential hidden inputs, for advanced analysis and reconnaissance.
  reference:
    - https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/05-Input_Validation_Testing
  tags: parameters, enumeration, reconnaissance, analysis

http:
  - method: GET
    path:
      - "{{BaseURL}}"
      - "{{BaseURL}}/login"
      - "{{BaseURL}}/search"
      - "{{BaseURL}}/register"
      - "{{BaseURL}}/signup"

    extractors:
      - type: regex
        name: query_parameters
        part: body
        regex:
          -  "[?&]([^=&]+)="
          - "^([^:]+):([^:]+):([0-9]+):([0-9]+):"
          - "<(?:input|select|textarea)[^>]*name=['\"]([^'\"]+)['\"]"
      - type: regex
        name: headers
        part: header
        regex:
          - "^([a-zA-Z0-9-]+):"
      - type: regex
        name: hidden_inputs
        part: body
        regex:
          - "<input[^>]*name=['\"]([a-zA-Z0-9_]+)['\"]"
